<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module Configs
 */


var configs, settings;

/**
 * @class
 */
configs = new (function() {
	/** @type {Object} fs dependency */
	this.fs	= {};
	/** @type {Object} lastRead array of configs */
	this.lastRead	= {};
	/** @type {Object} path dependency */
	this.path	= {};

	/**
	 * include relevant packages
	 */
	this.requireExternalDependencies = function() {
		this.chalk 	= require('chalk');
		this.fs		= require('fs');
		this.path	= require('path');
	};

	/**
	 * gets the last read configs
	 * @return {Object&lt;String, Object>} configs read into an object, using the filenames as a key
	 */
	this.get = function() {
		return this.lastRead;
	};

	/**
	 * recursively scans the directory
	 * @param  {String} dir      the directory to scan
	 * @param  {Array} filelist  is  an optional  parameter used recursively
	 * @return {Array}          a list of all files in dir
	 */
	this.walkSync = function(dir, filelist) {
		var fs, self;
		self = this;
		fs = fs || require('fs'),
		files = fs.readdirSync(dir);
		filelist = filelist || [];
		files.forEach(function(file) {
			if (fs.statSync(dir + '/' +file).isDirectory())
				filelist = self.walkSync(dir + '/' + file + '/', filelist);
			else
				filelist.push(dir+'/'+file);
		});
		return filelist;
	}; 

	/**
	 * reads config files from the fromFolder (default is "configs")
	 * @param  {String} fromFolder is the folder ffrom which to read
	 * @return {Array}            a listing of files
	 */
	this.readConfigFiles = function(fromFolder) {
		var curPath, files, itr, self;
		self = this;
		files = [];
		curPath = process.cwd() + '/' + fromFolder;
		if (this.fs.existsSync(curPath)) {
			files = files.concat(this.walkSync(curPath));
		}
		itr = function(path) {
			var curPath, cwd, files, i, packages;
			packages = [];
			if (!path)
				path = '';
			files = [];
			cwd = process.cwd();
			curPath = process.cwd() + path + '/node_modules';	
			if (self.fs.existsSync(curPath)) {
				packages = self.fs.readdirSync(curPath);
				for (i in packages) {
					if (self.fs.statSync(curPath + '/' + packages[i]).isDirectory()) {
						if (self.fs.existsSync(curPath + '/' + packages[i] + '/' + fromFolder))
							files = files.concat(self.walkSync(curPath + '/' + packages[i] + '/' + fromFolder));
						if (self.fs.existsSync(process.cwd() + path + '/node_modules/' + packages[i] + '/node_modules'))
							files = files.concat(itr(path + '/node_modules/' + packages[i])).reverse();
					}
				}
			}

			return files;
		};

		files = files.concat(itr()).reverse();
		return files;
	};

	/**
	 * reads the configs using a scandir
	 * @param  {String} fromFolder (optional) a relative path from process.cwd()
	 * @return  {Object&lt;String, Object>} configs read into an object, using the filenames as a key
	 */
	this.readConfigs = function(fromFolder) {
		var config, filename, files, fparts, i, keys, obj, path;

		if (typeof fromFolder == 'undefined')
			fromFolder 	= 'configs';

		files	= this.readConfigFiles(fromFolder);

		config	= this.lastRead;
		for (i in files) {
			if (typeof files[i] != 'string')
				continue;
			files[i]	= 	files[i].replace(/\\/g, '/');
			filename	= files[i].split('/');
			filename	= filename[filename.length - 1];
			fparts		= filename.split('.');
			if (fparts[fparts.length - 1] != 'json')
				continue;
			fparts.pop();
			filename	= fparts.join('.');
			try {
				obj	= JSON.parse(this.fs.readFileSync(files[i], 'UTF8'));
				if (!config[filename])
					config[filename] = {};
				config[filename]	= Object.assign(config[filename], obj);
			} catch(e) {
				console.error(this.chalk.red('Error: ') + 'had trouble reading the config ' + this.chalk.yellow(filename) + '.  Please check that the file contains valid JSON syntax and try again: ' + files[i]);
			}
		}
		this.lastRead	= config;
		return config;
	};

	delete require.cache[module.filename];
	return this;
});

configs.requireExternalDependencies();
configs.readConfigs();

module.exports = configs;
delete require.cache[module.filename];</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Configs.html">Configs</a></li></ul><h3>Classes</h3><ul><li><a href="module-Configs-configs.html">configs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed May 25 2016 12:16:26 GMT-0600 (Mountain Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
