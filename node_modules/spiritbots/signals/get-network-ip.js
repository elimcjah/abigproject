chalk	= require("chalk");
module.exports	= function(){
	var net = require('net');
	s	= Robots.wait();
	request	= require('request');
	request('https://api.ipify.org/',function(err,response,body){
 		if (err) {
			console.log(chalk.red("Error: network not detected, using api.ipify.com (down host?)"));
			Robots.finish(s,'127.0.0.1');
		}
		else
			Robots.finish(s,body);
	});
	return s;
}

/*
if ( app.config.hasOwnProperty('ip') )
	app.set('network-ip',app.config.ip);
else {
	app.set('network-ip','127.0.0.1');
	Robots.register('architect-loaded',function(){
		Robots.relayAsync('get-network-ip',function(ip){
			app.set('network-ip',ip);
		});
	});
}
*/