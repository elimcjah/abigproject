/**
 * @file
 * This file should overwrite the existing package.json to include a target 
 * called, "build-dependencies".
 */
let fs = require('fs');
let path = require('spiritfiles').getApplicationDirectory();
let json = JSON.parse(fs.readFileSync(path + '/package.json', 
    'UTF8'));
json['scripts']['build-dependencies'] = 'node node_modules/spiritdependencies' +
    '/build.js';
json['scripts']['update-dependencies'] = 'node node_modules/spiritdependencies' +
    '/update.js';
json['scripts']['clean-dependencies'] = 'node node_modules/spiritdependencies' +
    '/clean.js';
fs.writeFileSync(path + '/package.json', 
    JSON.stringify(json, null, 2));
    
try {
    if (!fs.existsSync(path + '/configs/dependencies.json')) {
        let config = {
            'ua-uuid': require('uuid/v4')()
        }
        fs.writeFileSync(path + '/configs/dependencies.json', 
            JSON.stringify(config, null, 2));
    } else {
        let config = JSON.parse(fs.readFileSync(path + '/configs/dependencies.json'));
        if (!config.hasOwnProperty('ua-uuid')) {
            config['ua-uuid'] = require('uuid/v4')();
        }
        fs.writeFileSync(path + '/configs/dependencies.json', 
            JSON.stringify(config, null, 2));
    }
} catch(e) {
}
process.exit();