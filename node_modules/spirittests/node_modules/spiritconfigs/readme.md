# Configs

Spiritconfigs simply include JSON configs in a directory using recursive scandir.

[![Build Status][travis-image]][travis-url] [![Coverage Status][coveralls-image]][coveralls-url]

![Ambassador IO Logo](https://raw.githubusercontent.com/mgwhitfield/AmbassadorNode/master/logo-icon-64.PNG)

[travis-image]: https://travis-ci.org/spiritway/configs.png?branch=master
[travis-url]: https://travis-ci.org/spiritway/configs

[coveralls-image]: https://coveralls.io/repos/spiritway/configs/badge.svg
[coveralls-url]: https://coveralls.io/repos/spiritway/configs/badge.svg

## Usage

By default, configs will look in your execution path for a **configs** folder.  Likewise, it will search in your node_modules packages for **configs** folders.  When ***require***'ing Spiritconfigs, you will receive a JSON object of all configs, **keyed by the filenames of the JSON files found in your config folders**.  For example, examine this directory structure:

```
    configs/default.json
    configs/myconfig.json
    node_modules/*
    node_modules/package_name/*
    node_modules/package_name/configs/default.json
    index.js
    package.json
```

By executing the following requires statement: ``require('spiritconfigs')`` you will receive an object with two keys and the JSON contents of their respective files:

```
    {
        'default': {...},
        'myconfig': {...}
    }
```

## Overrides and Defaults

By default, all configs placed in your execution directory will override node_modules packages using Object.assign (similar to jQuery.extend).  Therefore, if ``node_moodules/package_name/configs/default.json`` defines the property ``config_option`` as ``foo`` and ``configs/default.json`` defines the property ``config_option`` as ``bar``, the resulting configs object would look like this:

```
    {
        'default': {
            'config_option': 'bar',
            'should_read_documentation': '???',
            'some_other_option': 'foobar'
        },
        'myconfig': {...}
    }
```

To understand this example further, let's consider the contents of ``node_modules/package_name/configs/default.json`` and ``configs/default.json``:

**node_modules/package_name/configs/default.json**
```
    {
        'config_option': 'foo',
        'some_other_option': 'foobar'
    }
```

**configs/default.json**
```
    {
        'config_option': 'bar',
        'should_read_documentation': '???'
    }
```

When using ``require('spiritconfigs')['default']``, the value becomes:
```
    {
        'config_option': 'bar',
        'should_read_documentation': '???',
        'some_other_option': 'foobar'
    }
```

Likewise, you can programmatically control the inheritance of config options and supply config options when the filesystem has not already specified configs.  To do this, you must include the ``SpiritConfigs`` class file using ``require('spiritconfigs/spiritconfigs.class.js')``.  This gives you access to the SpiritConfigs singleton instance.  You can call the following two functions to control overrides and defaults:

```
    let spiritconfigs = require('spiritconfigs/spiritconfigs.class.js');
    spiritconfigs.setDefault('default', {
        'favorite_sport': 'tennis'
    });
    spiritConfigs.setOverride('default', {
        'should_read_documentation': true
    });
```

Note that you may need to re-read your configs after setting overrides and defaults.  Considering a config read using our defaults and overrides given the above example, we would generate the following value for ``require('spiritconfigs')['default']``:

```
    {
        'config_option': 'bar',
        'favorite_sport': 'tennis',
        'should_read_documentation': true,
        'some_other_option': 'foobar'
    }
```
