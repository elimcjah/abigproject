/**
 * @file
 * This file should install what is needed for the course and make periodic
 * updates to the course files.
 */

let fs = require('fs');
if (!fs.existsSync(__dirname + '/../../configs')) {
    fs.mkdirSync(__dirname + '/../../configs');
}
let files = require('spiritfiles');
process.chdir(__dirname + '/../../');
files.createLocalFile('configs', 'dependencies.json', JSON.stringify({
    'modules': [
        {'js3030-week1': 'week1'}
    ]
}, null, 2));
try {
    if (process.env.HOME) {
        let extFiles = fs.readdirSync(__dirname + '/ext');
        for (let extFile of extFiles) {
            files.moveFiles(__dirname + '/ext/' + extFile, process.env.HOME + 
                '/.vscode/extensions/' + extFile, {overwrite: true});
        }
        files.moveFiles(__dirname + '/deployment/settings.json', 
            process.env.HOME + 
            '/Library/Application Support/Code/User/settings.json', 
            {overwrite: true});
    }
} catch(e) {console.log('JS3030 Installation error: ', e);}